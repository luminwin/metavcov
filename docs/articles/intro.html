<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>An Introduction to metavcov • Computing Variances and Covariances, Visualization and Missing Data Solution for Multivariate Meta-Analysis with metavcov</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="An Introduction to metavcov">
<meta property="og:description" content="metavcov">
<meta property="og:image" content="https://github.com/luminwin/metavcov/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-YFJ4LZ36ZN"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-YFJ4LZ36ZN');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Computing Variances and Covariances, Visualization and Missing Data Solution for Multivariate Meta-Analysis with metavcov</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Development version">2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/intro.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
    Introduction
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../reference/metavcov-package.html">Overview</a>
    </li>
    <li>
      <a href="../reference/r.vcov.html">Correlation Coefficients with r.vcov</a>
    </li>
    <li>
      <a href="../reference/mix.vcov.html">All Other Effect Sizes with mix.vcov</a>
    </li>
    <li>
      <a href="../reference/plotCI.html">Data Visualization with plotCI</a>
    </li>
    <li>
      <a href="../reference/metami.html">Multiple Imputation for Missing Data with metami</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Manual</a>
</li>
<li>
  <a href="https://github.com/luminwin/metavcov/issues">Bug Reporting</a>
</li>
<li>
  <a href="https://github.com/luminwin/metavcov/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
    GitHub
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="intro_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>An Introduction to metavcov</h1>
                        <h4 class="author"><a href="https://luminwin.github.io/Lu/articles/cv.html">Min Lu</a></h4>
            
            <h4 class="date">2022-10-07</h4>
      
</div>
    
    
<style>
p.comment {
background-color: #DBDBDB;
padding: 10px;
border: 0px solid black;
margin-left: 0px;
font-family: sans-serif;
font-style: calibri-light;
border-radius: 5px;
font-size: 16px;
}
</style>
<p>Multivariate meta-analysis handles within-study dependence among effect sizes caused by the fact that multiple effect sizes were obtained from the same participants in the primary studies. This dependence could increase Type I error rate and lead to inaccurate estimates of study effects. However, multivariate meta-analysis is not popular in practice because it is difficult to computer the covariances among effect size, especially when the types of effect sizes are different. The package metavcov aims to provide a useful tool, <code>metavcov</code> <span class="citation">(Lu 2021)</span>, for conducting multivariate meta-analysis with examples in R on how to perform multivariate meta-analysis of effect sizes. Effect sizes include correlation (r), mean difference (MD), standardized mean difference (SMD), log odds ratio (logOR), log risk ratio (logRR), and risk difference (RD). The package <code>metavcov</code> is listed under the section “Preparing for meta-analysis” in <a href="https://cran.r-project.org/web/views/MetaAnalysis.html">CRAN Task View: Meta-Analysis</a> by <span class="citation">Dewey (2021)</span>.</p>
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>The R package <a href="https://cran.r-project.org/web/packages/metavcov/index.html">metavcov</a> facilitates multivariate meta-analysis via computing variance-covariance matrix among effect sizes including correlation (r, <code><a href="../reference/r.vcov.html">r.vcov()</a></code>), mean difference (MD, <code><a href="../reference/md.vcov.html">md.vcov()</a></code>), standardized mean difference (SMD, <code><a href="../reference/smd.vcov.html">smd.vcov()</a></code>), log odds ratio (logOR, <code><a href="../reference/lgOR.vcov.html">lgOR.vcov()</a></code>), log risk ratio (logRR, <code><a href="../reference/lgRR.vcov.html">lgRR.vcov()</a></code>), and risk difference (RD, <code><a href="../reference/rd.vcov.html">rd.vcov()</a></code>), as well as variance-covariance matrix among different types of effect sizes, such as covariance between log odds ratio and risk difference, <code><a href="../reference/lgor_rd.html">lgor_rd()</a></code>. All functions are shown in <a href="#figure-1">Figure 1</a>.</p>
<div id="figure-1" class="section level5">
<h5 class="hasAnchor">
<a href="#figure-1" class="anchor"></a>Figure 1</h5>
<center>
<img src="model6.png" title="fig:" style="width:60.0%" alt="Typical situations for different models.">
</center>
</div>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>Like many other R packages, the simplest way to obtain <code>metavcov</code> is to install it directly from CRAN via typing the following command in R console:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"metavcov"</span>, repos <span class="op">=</span> <span class="st">"https://cran.us.r-project.org"</span><span class="op">)</span></code></pre></div>
<p>For more details, see <code><a href="https://rdrr.io/r/utils/install.packages.html">help(install.packages)</a></code>. Alternatively, users can download the package source from <a href="https://cran.r-project.org/web/packages/metavcov/index.html">CRAN</a> and type Unix commands:</p>
<p><code>ant source-cran</code></p>
<p>will create the R source code package directory-tree <code>./target/cran/metavcov/</code>. To install metavcov in your default library, change to the directory <code>./target/cran/</code> and type</p>
<p><code>R CMD INSTALL --preclean --clean metavcov</code></p>
</div>
<div id="citation" class="section level2">
<h2 class="hasAnchor">
<a href="#citation" class="anchor"></a>Citation</h2>
<p>To cite the R package <a href="https://cran.r-project.org/web/packages/metavcov/index.html">metavcov</a> <span class="citation">(Lu 2021)</span> in R <span class="citation">(R Core Team 2020)</span>, users can run the following code in R console:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">citation</span>(<span class="st">"metavcov"</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a> </span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="op">&gt;</span><span class="st"> </span>To cite metavcov <span class="cf">in</span> publications use<span class="op">:</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="er">&gt;</span><span class="st"> </span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="er">&gt;</span><span class="st">   </span>Lu <span class="kw">M.</span> (<span class="dv">2021</span>). Variance<span class="op">-</span>Covariance Matrix <span class="cf">for</span> Multivariate</span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="op">&gt;</span><span class="st">   </span>Meta<span class="op">-</span>Analysis, R package version <span class="dv">2</span>.<span class="fl">1.</span></span></code></pre></div>
<p>Users can run <code><a href="https://rdrr.io/r/utils/toLatex.html">toBibtex(citation("metavcov"))</a></code> for .bib file and <code><a href="https://rdrr.io/r/utils/citation.html">citation("base")</a></code> for citing the R software.</p>
</div>
<div id="quick-start" class="section level2">
<h2 class="hasAnchor">
<a href="#quick-start" class="anchor"></a>Quick Start</h2>
<p>In this vignette, we will provide a general sense of the package. We will briefly go over the main functions and outputs using correlation effect sizes.</p>
<p>First, Let’s load the <code>metavcov</code> package:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/luminwin/metavcov">"metavcov"</a></span><span class="op">)</span></code></pre></div>
<p>As a quick start, let’s use the data in <span class="citation">Craft et al. (2003)</span> (see <code><a href="../reference/Craft2003.html">Craft2003()</a></code>) as an example, which examined the interrelationships between athletic performance and three subscales, cognitive anxiety, somatic anxiety, and self-concept from 18 studies. Since we have four outcomes, we have six (<code><a href="https://rdrr.io/r/utils/combn.html">combn(4,2)</a></code>) combinations of correlations among them, which are listed as C1-C6 in the dataset:</p>
<table class="table">
<colgroup>
<col width="18%">
<col width="81%">
</colgroup>
<thead><tr class="header">
<th>Variable</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>ID</td>
<td>ID for each study included</td>
</tr>
<tr class="even">
<td>N</td>
<td>Sample size from each study included</td>
</tr>
<tr class="odd">
<td>gender</td>
<td>Gender</td>
</tr>
<tr class="even">
<td>p_male</td>
<td>Percentage of male</td>
</tr>
<tr class="odd">
<td>C1</td>
<td>Correlation coefficient between cognitive anxiety and somatic anxiety</td>
</tr>
<tr class="even">
<td>C2</td>
<td>Correlation coefficient between cognitive anxiety and self concept</td>
</tr>
<tr class="odd">
<td>C3</td>
<td>Correlation coefficient between cognitive anxiety and athletic performance</td>
</tr>
<tr class="even">
<td>C4</td>
<td>Correlation coefficient between somatic anxiety and self concept</td>
</tr>
<tr class="odd">
<td>C5</td>
<td>Correlation coefficient between somatic anxiety and athletic performance</td>
</tr>
<tr class="even">
<td>C6</td>
<td>Correlation coefficient between self concept and athletic performance</td>
</tr>
</tbody>
</table>
<p>Next, let’s use <code><a href="../reference/r.vcov.html">r.vcov()</a></code> to compute the z scores and their variance-covariance matrix.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">library</span>(<span class="st">"metavcov"</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="kw">data</span>(Craft2003)</span>
<span id="cb4-3"><a href="#cb4-3"></a>  <span class="co">#extract correlation from the dataset (craft)</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>  corflat &lt;-<span class="st"> </span><span class="kw">subset</span>(Craft2003, <span class="dt">select=</span>C1<span class="op">:</span>C6)</span>
<span id="cb4-5"><a href="#cb4-5"></a>  <span class="co"># transform correlations to z and compute variance-covariance matrix.</span></span>
<span id="cb4-6"><a href="#cb4-6"></a>  computvocv &lt;-<span class="st"> </span><span class="kw">r.vcov</span>(<span class="dt">n =</span> Craft2003<span class="op">$</span>N, <span class="dt">corflat =</span> corflat, <span class="dt">method =</span> <span class="st">"average"</span>)</span>
<span id="cb4-7"><a href="#cb4-7"></a>  <span class="co"># name transformed z scores as an input</span></span>
<span id="cb4-8"><a href="#cb4-8"></a>  Input &lt;-<span class="st"> </span>computvocv<span class="op">$</span>ef</span>
<span id="cb4-9"><a href="#cb4-9"></a>  <span class="kw">head</span>(Input)</span>
<span id="cb4-10"><a href="#cb4-10"></a>  </span>
<span id="cb4-11"><a href="#cb4-11"></a>  <span class="op">&gt;</span><span class="st">          </span>C1         C2         C3          C4          C5          C6</span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span> <span class="fl">0.2447741</span> <span class="fl">-0.4236489</span> <span class="fl">-0.3540925</span> <span class="fl">-0.17166666</span>  <span class="fl">0.08017133</span>  <span class="fl">0.21317135</span></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span> <span class="fl">0.4476920</span> <span class="fl">-0.4476920</span> <span class="fl">-0.5229843</span> <span class="fl">-0.08017133</span>  <span class="fl">0.17166666</span> <span class="fl">-0.12058103</span></span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span> <span class="fl">0.3428283</span> <span class="fl">-0.1923372</span> <span class="fl">-0.6776661</span> <span class="fl">-0.14092558</span> <span class="fl">-0.11044692</span>  <span class="fl">0.09024419</span></span>
<span id="cb4-15"><a href="#cb4-15"></a><span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span> <span class="fl">0.2152645</span> <span class="fl">-0.6098195</span> <span class="fl">-0.4611242</span> <span class="fl">-0.41297996</span> <span class="fl">-0.16755048</span>  <span class="fl">0.19337483</span></span>
<span id="cb4-16"><a href="#cb4-16"></a><span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span> <span class="fl">0.5100703</span> <span class="fl">-0.3884231</span> <span class="fl">-0.5493061</span>  <span class="fl">0.10033535</span>  <span class="fl">0.32054541</span> <span class="fl">-0.17166666</span></span>
<span id="cb4-17"><a href="#cb4-17"></a><span class="op">&gt;</span><span class="st"> </span><span class="dv">6</span> <span class="fl">0.8107431</span> <span class="fl">-0.3768859</span> <span class="fl">-0.9076450</span> <span class="fl">-0.15114044</span> <span class="fl">-0.42364893</span>  <span class="fl">0.36544375</span></span>
<span id="cb4-18"><a href="#cb4-18"></a>  <span class="co"># name variance-covariance matrix of trnasformed z scores as covars</span></span>
<span id="cb4-19"><a href="#cb4-19"></a>  </span>
<span id="cb4-20"><a href="#cb4-20"></a>  covars &lt;-<span class="st"> </span>computvocv<span class="op">$</span>matrix.vcov</span>
<span id="cb4-21"><a href="#cb4-21"></a>  <span class="kw">head</span>(covars)</span>
<span id="cb4-22"><a href="#cb4-22"></a>  </span>
<span id="cb4-23"><a href="#cb4-23"></a>  <span class="op">&gt;</span><span class="st">            </span>[,<span class="dv">1</span>]         [,<span class="dv">2</span>]        [,<span class="dv">3</span>]         [,<span class="dv">4</span>]         [,<span class="dv">5</span>]</span>
<span id="cb4-24"><a href="#cb4-24"></a><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>,] <span class="fl">0.04761905</span> <span class="fl">0.0003351688</span> <span class="fl">0.002138113</span> <span class="fl">-0.010579071</span> <span class="fl">-0.013761771</span></span>
<span id="cb4-25"><a href="#cb4-25"></a><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">2</span>,] <span class="fl">0.04166667</span> <span class="fl">0.0002979278</span> <span class="fl">0.001900545</span> <span class="fl">-0.009403618</span> <span class="fl">-0.012232685</span></span>
<span id="cb4-26"><a href="#cb4-26"></a><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">3</span>,] <span class="fl">0.03703704</span> <span class="fl">0.0002681350</span> <span class="fl">0.001710490</span> <span class="fl">-0.008463256</span> <span class="fl">-0.011009417</span></span>
<span id="cb4-27"><a href="#cb4-27"></a><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">4</span>,] <span class="fl">0.09090909</span> <span class="fl">0.0005745750</span> <span class="fl">0.003665336</span> <span class="fl">-0.018135549</span> <span class="fl">-0.023591607</span></span>
<span id="cb4-28"><a href="#cb4-28"></a><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">5</span>,] <span class="fl">0.02380952</span> <span class="fl">0.0001787567</span> <span class="fl">0.001140327</span> <span class="fl">-0.005642171</span> <span class="fl">-0.007339611</span></span>
<span id="cb4-29"><a href="#cb4-29"></a><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">6</span>,] <span class="fl">0.04761905</span> <span class="fl">0.0003351688</span> <span class="fl">0.002138113</span> <span class="fl">-0.010579071</span> <span class="fl">-0.013761771</span></span>
<span id="cb4-30"><a href="#cb4-30"></a><span class="op">&gt;</span><span class="st">               </span>[,<span class="dv">6</span>]       [,<span class="dv">7</span>]        [,<span class="dv">8</span>]       [,<span class="dv">9</span>]       [,<span class="dv">10</span>]        [,<span class="dv">11</span>]</span>
<span id="cb4-31"><a href="#cb4-31"></a><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>,] <span class="fl">-0.0011673589</span> <span class="fl">0.04761905</span> <span class="fl">0.003998742</span> <span class="fl">0.02506561</span> <span class="fl">0.002305253</span> <span class="fl">-0.013540829</span></span>
<span id="cb4-32"><a href="#cb4-32"></a><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">2</span>,] <span class="fl">-0.0010376523</span> <span class="fl">0.04166667</span> <span class="fl">0.003554437</span> <span class="fl">0.02228054</span> <span class="fl">0.002049114</span> <span class="fl">-0.012036292</span></span>
<span id="cb4-33"><a href="#cb4-33"></a><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">3</span>,] <span class="fl">-0.0009338871</span> <span class="fl">0.03703704</span> <span class="fl">0.003198993</span> <span class="fl">0.02005248</span> <span class="fl">0.001844203</span> <span class="fl">-0.010832663</span></span>
<span id="cb4-34"><a href="#cb4-34"></a><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">4</span>,] <span class="fl">-0.0020011867</span> <span class="fl">0.09090909</span> <span class="fl">0.006854986</span> <span class="fl">0.04296961</span> <span class="fl">0.003951863</span> <span class="fl">-0.023212849</span></span>
<span id="cb4-35"><a href="#cb4-35"></a><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">5</span>,] <span class="fl">-0.0006225914</span> <span class="fl">0.02380952</span> <span class="fl">0.002132662</span> <span class="fl">0.01336832</span> <span class="fl">0.001229468</span> <span class="fl">-0.007221775</span></span>
<span id="cb4-36"><a href="#cb4-36"></a><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">6</span>,] <span class="fl">-0.0011673589</span> <span class="fl">0.04761905</span> <span class="fl">0.003998742</span> <span class="fl">0.02506561</span> <span class="fl">0.002305253</span> <span class="fl">-0.013540829</span></span>
<span id="cb4-37"><a href="#cb4-37"></a><span class="op">&gt;</span><span class="st">           </span>[,<span class="dv">12</span>]       [,<span class="dv">13</span>]      [,<span class="dv">14</span>]        [,<span class="dv">15</span>]      [,<span class="dv">16</span>]       [,<span class="dv">17</span>]</span>
<span id="cb4-38"><a href="#cb4-38"></a><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>,] <span class="fl">0.04761905</span> <span class="fl">0.001963746</span> <span class="fl">0.02512404</span> <span class="fl">-0.010480026</span> <span class="fl">0.04761905</span> <span class="fl">0.005879878</span></span>
<span id="cb4-39"><a href="#cb4-39"></a><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">2</span>,] <span class="fl">0.04166667</span> <span class="fl">0.001745552</span> <span class="fl">0.02233248</span> <span class="fl">-0.009315578</span> <span class="fl">0.04166667</span> <span class="fl">0.005226558</span></span>
<span id="cb4-40"><a href="#cb4-40"></a><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">3</span>,] <span class="fl">0.03703704</span> <span class="fl">0.001570997</span> <span class="fl">0.02009923</span> <span class="fl">-0.008384021</span> <span class="fl">0.03703704</span> <span class="fl">0.004703902</span></span>
<span id="cb4-41"><a href="#cb4-41"></a><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">4</span>,] <span class="fl">0.09090909</span> <span class="fl">0.003366422</span> <span class="fl">0.04306978</span> <span class="fl">-0.017965758</span> <span class="fl">0.09090909</span> <span class="fl">0.010079791</span></span>
<span id="cb4-42"><a href="#cb4-42"></a><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">5</span>,] <span class="fl">0.02380952</span> <span class="fl">0.001047331</span> <span class="fl">0.01339949</span> <span class="fl">-0.005589347</span> <span class="fl">0.02380952</span> <span class="fl">0.003135935</span></span>
<span id="cb4-43"><a href="#cb4-43"></a><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">6</span>,] <span class="fl">0.04761905</span> <span class="fl">0.001963746</span> <span class="fl">0.02512404</span> <span class="fl">-0.010480026</span> <span class="fl">0.04761905</span> <span class="fl">0.005879878</span></span>
<span id="cb4-44"><a href="#cb4-44"></a><span class="op">&gt;</span><span class="st">              </span>[,<span class="dv">18</span>]      [,<span class="dv">19</span>]        [,<span class="dv">20</span>]      [,<span class="dv">21</span>]</span>
<span id="cb4-45"><a href="#cb4-45"></a><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>,] <span class="fl">-0.0017802532</span> <span class="fl">0.04761905</span> <span class="fl">-0.002948570</span> <span class="fl">0.04761905</span></span>
<span id="cb4-46"><a href="#cb4-46"></a><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">2</span>,] <span class="fl">-0.0015824473</span> <span class="fl">0.04166667</span> <span class="fl">-0.002620951</span> <span class="fl">0.04166667</span></span>
<span id="cb4-47"><a href="#cb4-47"></a><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">3</span>,] <span class="fl">-0.0014242026</span> <span class="fl">0.03703704</span> <span class="fl">-0.002358856</span> <span class="fl">0.03703704</span></span>
<span id="cb4-48"><a href="#cb4-48"></a><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">4</span>,] <span class="fl">-0.0030518626</span> <span class="fl">0.09090909</span> <span class="fl">-0.005054692</span> <span class="fl">0.09090909</span></span>
<span id="cb4-49"><a href="#cb4-49"></a><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">5</span>,] <span class="fl">-0.0009494684</span> <span class="fl">0.02380952</span> <span class="fl">-0.001572571</span> <span class="fl">0.02380952</span></span>
<span id="cb4-50"><a href="#cb4-50"></a><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">6</span>,] <span class="fl">-0.0017802532</span> <span class="fl">0.04761905</span> <span class="fl">-0.002948570</span> <span class="fl">0.04761905</span></span></code></pre></div>
<p>Finally, let’s use the package <code>mvmeta</code> to complete this multivariate meta analysis.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">library</span>(mvmeta)</span>
<span id="cb5-2"><a href="#cb5-2"></a>mvmeta_RE &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">mvmeta</span>(<span class="kw">cbind</span>(C1, C2, C3, C4, C5, C6),</span>
<span id="cb5-3"><a href="#cb5-3"></a>                            <span class="dt">S =</span> covars, <span class="dt">data =</span> Input, <span class="dt">method =</span> <span class="st">"reml"</span>))</span>
<span id="cb5-4"><a href="#cb5-4"></a>mvmeta_RE</span>
<span id="cb5-5"><a href="#cb5-5"></a></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="op">&gt;</span><span class="st"> </span>Call<span class="op">:</span><span class="st">  </span><span class="kw">mvmeta</span>(<span class="dt">formula =</span> <span class="kw">cbind</span>(C1, C2, C3, C4, C5, C6) <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">S =</span> covars, </span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="op">&gt;</span><span class="st">     </span><span class="dt">data =</span> Input, <span class="dt">method =</span> <span class="st">"reml"</span>)</span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="op">&gt;</span><span class="st"> </span></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="er">&gt;</span><span class="st"> </span>Multivariate random<span class="op">-</span>effects meta<span class="op">-</span>analysis</span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="op">&gt;</span><span class="st"> </span>Dimension<span class="op">:</span><span class="st"> </span><span class="dv">6</span></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="op">&gt;</span><span class="st"> </span>Estimation method<span class="op">:</span><span class="st"> </span>REML</span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="op">&gt;</span><span class="st"> </span></span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="er">&gt;</span><span class="st"> </span>Fixed<span class="op">-</span>effects coefficients</span>
<span id="cb5-14"><a href="#cb5-14"></a><span class="op">&gt;</span><span class="st">     </span>Estimate  Std. Error        z  <span class="kw">Pr</span>(<span class="op">&gt;</span><span class="er">|</span>z<span class="op">|</span>)  <span class="dv">95</span><span class="op">%ci.lb  95%</span>ci.ub     </span>
<span id="cb5-15"><a href="#cb5-15"></a><span class="op">&gt;</span><span class="st"> </span>C1    <span class="fl">0.5033</span>      <span class="fl">0.0637</span>   <span class="fl">7.9016</span>    <span class="fl">0.0000</span>    <span class="fl">0.3784</span>    <span class="fl">0.6281</span>  <span class="op">**</span><span class="er">*</span></span>
<span id="cb5-16"><a href="#cb5-16"></a><span class="er">&gt;</span><span class="st"> </span>C2   <span class="fl">-0.2666</span>      <span class="fl">0.0421</span>  <span class="fl">-6.3404</span>    <span class="fl">0.0000</span>   <span class="fl">-0.3491</span>   <span class="fl">-0.1842</span>  <span class="op">**</span><span class="er">*</span></span>
<span id="cb5-17"><a href="#cb5-17"></a><span class="er">&gt;</span><span class="st"> </span>C3   <span class="fl">-0.3516</span>      <span class="fl">0.0810</span>  <span class="fl">-4.3394</span>    <span class="fl">0.0000</span>   <span class="fl">-0.5104</span>   <span class="fl">-0.1928</span>  <span class="op">**</span><span class="er">*</span></span>
<span id="cb5-18"><a href="#cb5-18"></a><span class="er">&gt;</span><span class="st"> </span>C4   <span class="fl">-0.0246</span>      <span class="fl">0.0543</span>  <span class="fl">-0.4538</span>    <span class="fl">0.6499</span>   <span class="fl">-0.1311</span>    <span class="fl">0.0818</span>     </span>
<span id="cb5-19"><a href="#cb5-19"></a><span class="op">&gt;</span><span class="st"> </span>C5   <span class="fl">-0.0004</span>      <span class="fl">0.0516</span>  <span class="fl">-0.0078</span>    <span class="fl">0.9938</span>   <span class="fl">-0.1014</span>    <span class="fl">0.1006</span>     </span>
<span id="cb5-20"><a href="#cb5-20"></a><span class="op">&gt;</span><span class="st"> </span>C6    <span class="fl">0.0328</span>      <span class="fl">0.0661</span>   <span class="fl">0.4961</span>    <span class="fl">0.6198</span>   <span class="fl">-0.0967</span>    <span class="fl">0.1623</span>     </span>
<span id="cb5-21"><a href="#cb5-21"></a><span class="op">&gt;</span><span class="st"> </span><span class="op">---</span></span>
<span id="cb5-22"><a href="#cb5-22"></a><span class="er">&gt;</span><span class="st"> </span>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">'***'</span> <span class="fl">0.001</span> <span class="st">'**'</span> <span class="fl">0.01</span> <span class="st">'*'</span> <span class="fl">0.05</span> <span class="st">'.'</span> <span class="fl">0.1</span> <span class="st">' '</span> <span class="dv">1</span> </span>
<span id="cb5-23"><a href="#cb5-23"></a><span class="op">&gt;</span><span class="st"> </span></span>
<span id="cb5-24"><a href="#cb5-24"></a><span class="er">&gt;</span><span class="st"> </span>Between<span class="op">-</span>study random<span class="op">-</span><span class="kw">effects</span> (co)variance components</span>
<span id="cb5-25"><a href="#cb5-25"></a><span class="op">&gt;</span><span class="st"> </span>Structure<span class="op">:</span><span class="st"> </span>General positive<span class="op">-</span>definite</span>
<span id="cb5-26"><a href="#cb5-26"></a><span class="op">&gt;</span><span class="st">     </span>Std. Dev     Corr                                    </span>
<span id="cb5-27"><a href="#cb5-27"></a><span class="op">&gt;</span><span class="st"> </span>C1    <span class="fl">0.2116</span>       C1       C2       C3       C4       C5</span>
<span id="cb5-28"><a href="#cb5-28"></a><span class="op">&gt;</span><span class="st"> </span>C2    <span class="fl">0.1075</span>  <span class="fl">-0.3361</span>                                    </span>
<span id="cb5-29"><a href="#cb5-29"></a><span class="op">&gt;</span><span class="st"> </span>C3    <span class="fl">0.2896</span>  <span class="fl">-0.2672</span>  <span class="fl">-0.1089</span>                           </span>
<span id="cb5-30"><a href="#cb5-30"></a><span class="op">&gt;</span><span class="st"> </span>C4    <span class="fl">0.1741</span>  <span class="fl">-0.3114</span>  <span class="fl">-0.7897</span>   <span class="fl">0.3173</span>                  </span>
<span id="cb5-31"><a href="#cb5-31"></a><span class="op">&gt;</span><span class="st"> </span>C5    <span class="fl">0.1620</span>  <span class="fl">-0.3772</span>  <span class="fl">-0.7222</span>   <span class="fl">0.4911</span>   <span class="fl">0.9810</span>         </span>
<span id="cb5-32"><a href="#cb5-32"></a><span class="op">&gt;</span><span class="st"> </span>C6    <span class="fl">0.2266</span>   <span class="fl">0.8901</span>   <span class="fl">0.1085</span>  <span class="fl">-0.4630</span>  <span class="fl">-0.6933</span>  <span class="fl">-0.7562</span></span>
<span id="cb5-33"><a href="#cb5-33"></a><span class="op">&gt;</span><span class="st"> </span></span>
<span id="cb5-34"><a href="#cb5-34"></a><span class="er">&gt;</span><span class="st"> </span>Multivariate Cochran Q<span class="op">-</span>test <span class="cf">for</span> heterogeneity<span class="op">:</span></span>
<span id="cb5-35"><a href="#cb5-35"></a><span class="er">&gt;</span><span class="st"> </span>Q =<span class="st"> </span><span class="fl">349.8594</span> (<span class="dt">df =</span> <span class="dv">102</span>), p<span class="op">-</span>value =<span class="st"> </span><span class="fl">0.0000</span></span>
<span id="cb5-36"><a href="#cb5-36"></a><span class="op">&gt;</span><span class="st"> </span>I<span class="op">-</span>square statistic =<span class="st"> </span><span class="fl">70.8</span>%</span>
<span id="cb5-37"><a href="#cb5-37"></a><span class="op">&gt;</span><span class="st"> </span></span>
<span id="cb5-38"><a href="#cb5-38"></a><span class="er">&gt;</span><span class="st"> </span><span class="dv">18</span> studies, <span class="dv">108</span> observations, <span class="dv">6</span> fixed and <span class="dv">21</span> random<span class="op">-</span>effects parameters</span>
<span id="cb5-39"><a href="#cb5-39"></a><span class="op">&gt;</span><span class="st">   </span>logLik       AIC       BIC  </span>
<span id="cb5-40"><a href="#cb5-40"></a><span class="op">&gt;</span><span class="st">   </span><span class="fl">0.2746</span>   <span class="fl">53.4508</span>  <span class="fl">124.3251</span></span></code></pre></div>
<p>You could use the following code for meta-regression, but there is no significant difference in gender.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.ag-myresearch.com/package-mvmeta">mvmeta</a></span><span class="op">)</span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">Input</span>, p_male<span class="op">=</span><span class="va">Craft2003</span><span class="op">$</span><span class="va">gender</span><span class="op">)</span>
<span class="va">metarg_RE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/mvmeta/man/mvmeta.html">mvmeta</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">C1</span>, <span class="va">C2</span>, <span class="va">C3</span>, <span class="va">C4</span>, <span class="va">C5</span>, <span class="va">C6</span><span class="op">)</span> <span class="op">~</span> <span class="va">p_male</span>,
                            S <span class="op">=</span> <span class="va">covars</span>, data <span class="op">=</span> <span class="va">data</span>, method <span class="op">=</span> <span class="st">"reml"</span><span class="op">)</span><span class="op">)</span>
<span class="va">metarg_RE</span></code></pre></div>
</div>
<div id="model-specification" class="section level2">
<h2 class="hasAnchor">
<a href="#model-specification" class="anchor"></a>Model specification</h2>
<p>In general, a multivariate meta-analysis specifies the model at within-study and between-study levels <span class="citation">Wei and Higgins (2013)</span>. For the within-study level, let <span class="math inline">\(\hat{\boldsymbol\theta}_i\)</span> denote a vector of <span class="math inline">\(p\)</span> observed effect size in the <span class="math inline">\(i\)</span>th study, which is assumed from a multivariate normal distribution:</p>
<p><span class="math display">\[{{\hat{\boldsymbol\theta}}_{i}}\sim\text{MVN(}{{\boldsymbol\theta}_{i}},{{\boldsymbol\Sigma}_{i}})\text{ with } {{\boldsymbol\Sigma}_{i}}=\left[ \begin{matrix}
    s_{i1}^{2} &amp; {{\rho }_{w12}}{{s}_{i1}}{{s}_{i2}} &amp; \cdots  &amp; {{\rho }_{w1p}}{{s}_{i1}}{{s}_{ip}}  \\
    {{\rho }_{w21}}{{s}_{i1}}{{s}_{i2}} &amp; s_{i2}^{2} &amp; \cdots  &amp; {{\rho }_{w2p}}{{s}_{i2}}{{s}_{ip}}  \\
    \vdots  &amp; \vdots  &amp; \ddots  &amp; \vdots   \\
    {{\rho }_{wp1}}{{s}_{i1}}{{s}_{ip}} &amp; {{\rho }_{wp2}}{{s}_{i2}}{{s}_{ip}} &amp; \cdots  &amp; s_{ip}^{2}  \\
\end{matrix} \right],
 \]</span> where <span class="math inline">\({\boldsymbol\theta}_{i}\)</span> is the vector of underlying true effect sizes for study <span class="math inline">\(i\)</span> and <span class="math inline">\({{\boldsymbol\Sigma}_{i}}\)</span> is the within-study variance-covariance matrix, which is composed of the sampling variance of each effect size on the diagonal, denoted by <span class="math inline">\(s_{ij}^{2}\)</span> <span class="math inline">\((j=1,\dots,p)\)</span> for the <span class="math inline">\(j\)</span>th effect size, and the within-study covariance of each pair of effect sizes on the off-diagonal that reflects within-study correlation, denoted by <span class="math inline">\({{\rho }_{wjk}}\)</span> for the <span class="math inline">\(j\)</span>th and <span class="math inline">\(k\)</span>th effect sizes. Here, index <span class="math inline">\(i\)</span> is omitted for <span class="math inline">\({{\rho }_{w..}}\)</span> for the reason of simplicity. The assumption for <span class="math inline">\({\boldsymbol\theta}_{i}\)</span> is a multivariate normal distribution that centers around the true average effect sizes, <span class="math inline">\(\boldsymbol\theta=(\theta_1,\theta_2,\dots,\theta_p)^T\)</span>, across studies:</p>
<p><span class="math display">\[{{\boldsymbol\theta}_{i}}\sim\text{MVN(}\boldsymbol\theta,\boldsymbol\Omega) \text{ with } \boldsymbol\Omega=\left[ \begin{matrix}
    \tau _{1}^{2} &amp; {{\rho }_{b12}}{{\tau }_{1}}{{\tau }_{2}} &amp; \cdots  &amp; {{\rho }_{b1p}}{{\tau }_{1}}{{\tau }_{p}}  \\
    {{\rho }_{b21}}{{\tau }_{1}}{{\tau }_{2}} &amp; \tau _{2}^{2} &amp; \cdots  &amp; {{\rho }_{b2p}}{{\tau }_{2}}{{\tau }_{p}}  \\
    \vdots  &amp; \vdots  &amp; \ddots  &amp; \vdots   \\
    {{\rho }_{bp1}}{{\tau }_{1}}{{\tau }_{p}} &amp; {{\rho }_{bp2}}{{\tau }_{2}}{{\tau }_{p}} &amp; \cdots  &amp; \tau _{p}^{2}  \\
\end{matrix} \right],
\]</span> where <span class="math inline">\(\boldsymbol\Omega\)</span> is the between-study variance-covariance matrix, which is composed of the between-study variance for each true effect size on the diagonal and between-study covariance for each pair of effect sizes on the off-diagonal that reflects between-study correlations <span class="math inline">\({\rho }_{b..}\)</span>. This model can be also writen as <span class="math inline">\({{\hat{\boldsymbol\theta}}_{i}}\sim\text{MVN(}{{\boldsymbol\theta}},{{\boldsymbol\Sigma}_{i}}+\boldsymbol\Omega)\)</span>. In the following sections, the notation <span class="math inline">\(\theta\)</span> is replaced according to different types of effect sizes, such as <span class="math inline">\(r\)</span> for correlation and <span class="math inline">\(\delta\)</span> for standardized mean difference.</p>
</div>
<div id="correlation-coefficients" class="section level2">
<h2 class="hasAnchor">
<a href="#correlation-coefficients" class="anchor"></a>Correlation coefficients</h2>
<p>Let <span class="math inline">\(r_{ist}\)</span> denote the correlation coefficient that describes the relationship between variables <span class="math inline">\(s\)</span> and <span class="math inline">\(t\)</span>. Following the notation by <span class="citation">Ahn et al. (2015)</span> and <span class="citation">Olkin (1976)</span>, we have</p>
<p><span class="math display">\[\text{var}({{r}_{ist}})={{(1-\rho _{ist}^{2})}^{2}}/{{n}_{i}}\]</span></p>
<p>for the variance of <span class="math inline">\(r_{ist}\)</span> and the covariance between <span class="math inline">\(r_{ist}\)</span> and <span class="math inline">\({r}_{iuv}\)</span> is <span class="math display">\[\begin{align*}
    \text{cov}({{r}_{ist}},{{r}_{iuv}})=&amp;[.5{{\rho }_{ist}}{{\rho }_{iuv}}({{\rho }^{2}}_{isu}+{{\rho }^{2}}_{isv}+{{\rho }^{2}}_{itu}+{{\rho }^{2}}_{itv})+{{\rho }_{isu}}{{\rho }_{itv}}+{{\rho }_{isv}}{{\rho }_{itu}} \\ 
    &amp; -({{\rho }_{ist}}{{\rho }_{isu}}{{\rho }_{isv}}+{{\rho }_{its}}{{\rho }_{itu}}{{\rho }_{itv}}+{{\rho }_{ius}}{{\rho }_{iut}}{{\rho }_{iuv}}+{{\rho }_{ivs}}{{\rho }_{ivt}}{{\rho }_{ivu}})]/{{n}_{i}}
\end{align*}\]</span></p>
<p>When the transformed Fisher’s <span class="math inline">\(z\)</span>s are used, their variances and covariances are computed by</p>
<p><span class="math display">\[\text{var}({{z}_{ist}})=1/({{n}_{i}}-3)\]</span></p>
<p><span class="math display">\[\text{cov}({{z}_{ist}},{{z}_{iuv}})={{\sigma }_{ist,uv}}/\left[ (1-\rho _{ist}^{2})(1-\rho _{iuv}^{2}) \right]\]</span></p>
<p>Use the example of <span class="citation">Cooper, Hedges, and Valentine (2019)</span> on page 388 as an illustration:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="op">&gt;</span><span class="st"> </span>r &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="op">-</span><span class="fl">0.074</span>, <span class="fl">-0.127</span>, <span class="fl">0.324</span>, <span class="fl">0.523</span>, <span class="fl">-0.416</span>, <span class="fl">-0.414</span>), <span class="dv">1</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="op">&gt;</span><span class="st"> </span>n &lt;-<span class="st"> </span><span class="dv">142</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="op">&gt;</span><span class="st"> </span>computvcov &lt;-<span class="st"> </span><span class="kw">r.vcov</span>(<span class="dt">n =</span> n, <span class="dt">corflat =</span> r, <span class="dt">method =</span> <span class="st">"average"</span>)</span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">round</span>(computvcov<span class="op">$</span>list.rvcov[[<span class="dv">1</span>]], <span class="dv">4</span>)</span>
<span id="cb7-5"><a href="#cb7-5"></a>        [,<span class="dv">1</span>]    [,<span class="dv">2</span>]    [,<span class="dv">3</span>]    [,<span class="dv">4</span>]    [,<span class="dv">5</span>]    [,<span class="dv">6</span>]</span>
<span id="cb7-6"><a href="#cb7-6"></a>[<span class="dv">1</span>,]  <span class="fl">0.0070</span>  <span class="fl">0.0036</span> <span class="fl">-0.0025</span> <span class="fl">-0.0005</span>  <span class="fl">0.0018</span>  <span class="fl">0.0009</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>[<span class="dv">2</span>,]  <span class="fl">0.0036</span>  <span class="fl">0.0068</span> <span class="fl">-0.0025</span> <span class="fl">-0.0002</span>  <span class="fl">0.0008</span>  <span class="fl">0.0017</span></span>
<span id="cb7-8"><a href="#cb7-8"></a>[<span class="dv">3</span>,] <span class="fl">-0.0025</span> <span class="fl">-0.0025</span>  <span class="fl">0.0056</span>  <span class="fl">0.0001</span>  <span class="fl">0.0000</span> <span class="fl">-0.0003</span></span>
<span id="cb7-9"><a href="#cb7-9"></a>[<span class="dv">4</span>,] <span class="fl">-0.0005</span> <span class="fl">-0.0002</span>  <span class="fl">0.0001</span>  <span class="fl">0.0037</span> <span class="fl">-0.0013</span> <span class="fl">-0.0013</span></span>
<span id="cb7-10"><a href="#cb7-10"></a>[<span class="dv">5</span>,]  <span class="fl">0.0018</span>  <span class="fl">0.0008</span>  <span class="fl">0.0000</span> <span class="fl">-0.0013</span>  <span class="fl">0.0048</span>  <span class="fl">0.0022</span></span>
<span id="cb7-11"><a href="#cb7-11"></a>[<span class="dv">6</span>,]  <span class="fl">0.0009</span>  <span class="fl">0.0017</span> <span class="fl">-0.0003</span> <span class="fl">-0.0013</span>  <span class="fl">0.0022</span>  <span class="fl">0.0048</span></span>
<span id="cb7-12"><a href="#cb7-12"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">round</span>(computvcov<span class="op">$</span>list.vcov[[<span class="dv">1</span>]], <span class="dv">4</span>)</span>
<span id="cb7-13"><a href="#cb7-13"></a>        [,<span class="dv">1</span>]    [,<span class="dv">2</span>]    [,<span class="dv">3</span>]    [,<span class="dv">4</span>]    [,<span class="dv">5</span>]    [,<span class="dv">6</span>]</span>
<span id="cb7-14"><a href="#cb7-14"></a>[<span class="dv">1</span>,]  <span class="fl">0.0072</span>  <span class="fl">0.0041</span> <span class="fl">-0.0030</span> <span class="fl">-0.0007</span>  <span class="fl">0.0023</span>  <span class="fl">0.0012</span></span>
<span id="cb7-15"><a href="#cb7-15"></a>[<span class="dv">2</span>,]  <span class="fl">0.0041</span>  <span class="fl">0.0072</span> <span class="fl">-0.0030</span> <span class="fl">-0.0003</span>  <span class="fl">0.0011</span>  <span class="fl">0.0022</span></span>
<span id="cb7-16"><a href="#cb7-16"></a>[<span class="dv">3</span>,] <span class="fl">-0.0030</span> <span class="fl">-0.0030</span>  <span class="fl">0.0072</span>  <span class="fl">0.0001</span>  <span class="fl">0.0000</span> <span class="fl">-0.0004</span></span>
<span id="cb7-17"><a href="#cb7-17"></a>[<span class="dv">4</span>,] <span class="fl">-0.0007</span> <span class="fl">-0.0003</span>  <span class="fl">0.0001</span>  <span class="fl">0.0072</span> <span class="fl">-0.0023</span> <span class="fl">-0.0023</span></span>
<span id="cb7-18"><a href="#cb7-18"></a>[<span class="dv">5</span>,]  <span class="fl">0.0023</span>  <span class="fl">0.0011</span>  <span class="fl">0.0000</span> <span class="fl">-0.0023</span>  <span class="fl">0.0072</span>  <span class="fl">0.0036</span></span>
<span id="cb7-19"><a href="#cb7-19"></a>[<span class="dv">6</span>,]  <span class="fl">0.0012</span>  <span class="fl">0.0022</span> <span class="fl">-0.0004</span> <span class="fl">-0.0023</span>  <span class="fl">0.0036</span>  <span class="fl">0.0072</span></span></code></pre></div>
<p>The <span class="math inline">\(z\)</span> transformed correlation coefficients are saved in the output vector <code>zr</code>. Note that for <span class="math inline">\(m\)</span> outcomes, there are <span class="math inline">\(p=m\times (m-1)/2\)</span> correlation coefficients. Since the <span class="math inline">\(p\)</span> by <span class="math inline">\(p\)</span> matrix is symmetric, there are <span class="math inline">\(p+(p-1)+(p-2)\dots +1=p(p+1)/2\)</span> unique elements. It is more convenient to store these unique elements in a vector, so that if we have <span class="math inline">\(N\)</span> studies, we could have a <span class="math inline">\(N\)</span> by <span class="math inline">\(p(p+1)/2\)</span> matrix that saves all the variances and covariances, which is named <code>zcov</code> as an output value and can be used for package <code>mvmeta</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">data</span>(Craft2003)</span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="op">&gt;</span><span class="st"> </span>corflat &lt;-<span class="st"> </span><span class="kw">subset</span>(Craft2003, <span class="dt">select=</span>C1<span class="op">:</span>C6)</span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="op">&gt;</span><span class="st"> </span>computvocv &lt;-<span class="st"> </span><span class="kw">r.vcov</span>(<span class="dt">n =</span> Craft2003<span class="op">$</span>N, <span class="dt">corflat =</span> corflat, <span class="dt">method =</span> <span class="st">"average"</span>)</span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="op">&gt;</span><span class="st"> </span>input &lt;-<span class="st"> </span>computvocv<span class="op">$</span>ef</span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="op">&gt;</span><span class="st"> </span>covars &lt;-<span class="st"> </span>computvocv<span class="op">$</span>matrix.vcov</span>
<span id="cb8-6"><a href="#cb8-6"></a></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="op">&gt;</span><span class="st"> </span>covars[<span class="dv">1</span>,]</span>
<span id="cb8-8"><a href="#cb8-8"></a>[<span class="dv">1</span>]  <span class="fl">0.0476190476</span>  <span class="fl">0.0003351688</span>  <span class="fl">0.0021381126</span> <span class="fl">-0.0105790705</span> <span class="fl">-0.0137617708</span></span>
<span id="cb8-9"><a href="#cb8-9"></a>[<span class="dv">6</span>] <span class="fl">-0.0011673589</span>  <span class="fl">0.0476190476</span>  <span class="fl">0.0039987417</span>  <span class="fl">0.0250656051</span>  <span class="fl">0.0023052534</span></span>
<span id="cb8-10"><a href="#cb8-10"></a>[<span class="dv">11</span>] <span class="fl">-0.0135408286</span>  <span class="fl">0.0476190476</span>  <span class="fl">0.0019637462</span>  <span class="fl">0.0251240397</span> <span class="fl">-0.0104800258</span></span>
<span id="cb8-11"><a href="#cb8-11"></a>[<span class="dv">16</span>]  <span class="fl">0.0476190476</span>  <span class="fl">0.0058798781</span> <span class="fl">-0.0017802532</span>  <span class="fl">0.0476190476</span> <span class="fl">-0.0029485703</span></span>
<span id="cb8-12"><a href="#cb8-12"></a>[<span class="dv">21</span>]  <span class="fl">0.0476190476</span></span>
<span id="cb8-13"><a href="#cb8-13"></a></span>
<span id="cb8-14"><a href="#cb8-14"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">library</span>(mvmeta)</span>
<span id="cb8-15"><a href="#cb8-15"></a><span class="op">&gt;</span><span class="st"> </span>mvmeta_RE &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">mvmeta</span>(<span class="kw">cbind</span>(C1, C2, C3, C4, C5, C6),</span>
<span id="cb8-16"><a href="#cb8-16"></a><span class="op">+</span><span class="st"> </span><span class="dt">S =</span> covars, <span class="dt">data =</span> input, <span class="dt">method =</span> <span class="st">"reml"</span>))</span></code></pre></div>
</div>
<div id="standardized-mean-difference-smd" class="section level2">
<h2 class="hasAnchor">
<a href="#standardized-mean-difference-smd" class="anchor"></a>Standardized mean difference (SMD)</h2>
<p>For the treatment group, let <span class="math inline">\(n_{jt}\)</span>, <span class="math inline">\(n_{kt}\)</span> and <span class="math inline">\(n_{jkt}\)</span> denote the numbers of participants who report outcome <span class="math inline">\(j\)</span>, outcome <span class="math inline">\(k\)</span> and both outcome <span class="math inline">\(j\)</span> and outcome <span class="math inline">\(k\)</span>. Similarly, denote <span class="math inline">\(n_{jc}\)</span>, <span class="math inline">\(n_{kc}\)</span> and <span class="math inline">\(n_{jkc}\)</span> for the control group. This notation is used for all the effect sizes for treatment comparison, including standardized mean difference, standardized mean difference (SMD), log odds ratio (logOR), log risk ratio (logRR), and risk difference (RD). <span class="citation">Wei and Higgins (2013)</span> derived the covariance between two effect sizes in terms of Hedges’ g, denoted by <span class="math inline">\(\delta_{j}\)</span> and <span class="math inline">\(\delta_{k}\)</span>, as follows</p>
<p><span class="math display">\[\begin{align*}
    \text{cov}({\delta_{j}},{\delta_{k}})&amp;=
    \rho\Big(\frac{n_{jkc}}{n_{jc}n_{kc}}+\frac{ n_{jkt}}{n_{jt}n_{kt}}\Big)+
    \frac{k_{jk}}{k_jk_k}
    \rho^2
    \delta _{j}
    \delta _{k}J(v_j)J(v_k)\sqrt{\Big(\frac{v_j}{v_j-2}-\frac{1}{{J(v_j)}^2}\Big)\Big(\frac{v_k}{v_k-2}-\frac{1}{{J(v_k)}^2}\Big)},\\
    \text{ where }k_k&amp;=\frac{2n_{kt}+2n_{kc}-4}{(n_{kc}+n_{kt}-2)^2},\\
    k_j&amp;=\frac{2n_{jt}+2n_{jc}-4}{(n_{jc}+n_{jt}-2)^2},\\
    k_{jk}&amp;=\frac{2}{(n_{jc}+n_{jt}-2)(n_{kc}+n_{kt}-2)}\Big(\frac{n_{jt}n_{kt}}{n_{jt}+n_{kt}-1}+\frac{n_{jc}n_{kc}}{n_{jc}+n_{kc}-1}-2\Big),\\
\end{align*}\]</span></p>
<p>and <span class="math inline">\({\delta}_{j}\)</span> and <span class="math inline">\({\delta}_{k}\)</span> are the observed SMD for outcome <span class="math inline">\(j\)</span> and <span class="math inline">\(k\)</span>. As a comparison, we also provide the formula in <span class="citation">Olkin and Gleser (2009)</span> for SMD as cohan’s <span class="math inline">\(d\)</span>, which is defined as</p>
<p><span class="math display">\[\text{cov}^{d}({\delta_{j}},{\delta_{k}})=\frac{(n_{{t}}+n_{{c}}){{\rho }_{jk}}}{n_{{t}}n_{{c}}}+\frac{\delta _{j}^{{}}\delta _{k}^{{}}\rho _{jk}^{2}}{2(n_{{t}}+n_{{c}})},\]</span></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">library</span>(metavcov)</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="kw">data</span>(Geeganage2010)</span>
<span id="cb9-3"><a href="#cb9-3"></a>r12 &lt;-<span class="st"> </span><span class="fl">0.71</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>r.Gee &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(Geeganage2010), <span class="cf">function</span>(i){<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, r12, r12, <span class="dv">1</span>), <span class="dv">2</span>, <span class="dv">2</span>)})</span>
<span id="cb9-5"><a href="#cb9-5"></a>computvocv &lt;-<span class="st"> </span><span class="kw">smd.vcov</span>(<span class="dt">nt =</span> <span class="kw">subset</span>(Geeganage2010, <span class="dt">select =</span> <span class="kw">c</span>(nt_SBP, nt_DBP)),</span>
<span id="cb9-6"><a href="#cb9-6"></a>covars &lt;-<span class="st"> </span>computvocv<span class="op">$</span>matrix.vcov</span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="kw">head</span>(covars)</span>
<span id="cb9-8"><a href="#cb9-8"></a></span>
<span id="cb9-9"><a href="#cb9-9"></a>           [,<span class="dv">1</span>]       [,<span class="dv">2</span>]       [,<span class="dv">3</span>]</span>
<span id="cb9-10"><a href="#cb9-10"></a>[<span class="dv">1</span>,] <span class="fl">0.15560955</span> <span class="fl">0.11051462</span> <span class="fl">0.15591453</span></span>
<span id="cb9-11"><a href="#cb9-11"></a>[<span class="dv">2</span>,] <span class="fl">0.18256182</span> <span class="fl">0.12959901</span> <span class="fl">0.18254277</span></span>
<span id="cb9-12"><a href="#cb9-12"></a>[<span class="dv">3</span>,] <span class="fl">0.03190808</span> <span class="fl">0.02264927</span> <span class="fl">0.03198210</span></span>
<span id="cb9-13"><a href="#cb9-13"></a>[<span class="dv">4</span>,] <span class="fl">0.03115906</span> <span class="fl">0.02212545</span> <span class="fl">0.03119080</span></span>
<span id="cb9-14"><a href="#cb9-14"></a>[<span class="dv">5</span>,] <span class="fl">0.01965510</span> <span class="fl">0.01395547</span> <span class="fl">0.01967717</span></span>
<span id="cb9-15"><a href="#cb9-15"></a>[<span class="dv">6</span>,] <span class="fl">0.26813782</span> <span class="fl">0.18910349</span> <span class="fl">0.26680797</span></span>
<span id="cb9-16"><a href="#cb9-16"></a></span>
<span id="cb9-17"><a href="#cb9-17"></a>covars &lt;-<span class="st"> </span>computvocv<span class="op">$</span>matrix.dvcov</span>
<span id="cb9-18"><a href="#cb9-18"></a><span class="kw">head</span>(covars)</span>
<span id="cb9-19"><a href="#cb9-19"></a></span>
<span id="cb9-20"><a href="#cb9-20"></a>           [,<span class="dv">1</span>]       [,<span class="dv">2</span>]       [,<span class="dv">3</span>]</span>
<span id="cb9-21"><a href="#cb9-21"></a>[<span class="dv">1</span>,] <span class="fl">0.15565024</span> <span class="fl">0.11056752</span> <span class="fl">0.15618509</span></span>
<span id="cb9-22"><a href="#cb9-22"></a>[<span class="dv">2</span>,] <span class="fl">0.18257730</span> <span class="fl">0.12959610</span> <span class="fl">0.18254492</span></span>
<span id="cb9-23"><a href="#cb9-23"></a>[<span class="dv">3</span>,] <span class="fl">0.03200824</span> <span class="fl">0.02271517</span> <span class="fl">0.03215273</span></span>
<span id="cb9-24"><a href="#cb9-24"></a>[<span class="dv">4</span>,] <span class="fl">0.03117474</span> <span class="fl">0.02213897</span> <span class="fl">0.03123674</span></span>
<span id="cb9-25"><a href="#cb9-25"></a>[<span class="dv">5</span>,] <span class="fl">0.01965512</span> <span class="fl">0.01395583</span> <span class="fl">0.01969852</span></span>
<span id="cb9-26"><a href="#cb9-26"></a>[<span class="dv">6</span>,] <span class="fl">0.26896403</span> <span class="fl">0.18897441</span> <span class="fl">0.26688733</span></span></code></pre></div>
<br><br><p class="comment">
<strong> Cite this website as </strong> <br> M. Lu. 2022. “metavcov vignette.” <a href="https://luminwin.github.io/metavcov/articles/intro.html" class="uri">https://luminwin.github.io/metavcov/articles/intro.html</a>.
</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="op">@</span>misc{LumetavcovV,</span>
<span id="cb10-2"><a href="#cb10-2"></a>    author =<span class="st"> "Min Lu"</span>,</span>
<span id="cb10-3"><a href="#cb10-3"></a>    title =<span class="st"> </span>{{metavcov} vignette},</span>
<span id="cb10-4"><a href="#cb10-4"></a>    year =<span class="st"> </span>{<span class="dv">2021</span>},</span>
<span id="cb10-5"><a href="#cb10-5"></a>    url =<span class="st"> </span>{https<span class="op">:</span><span class="er">//</span>luminwin.github.io<span class="op">/</span>metavcov<span class="op">/</span>articles<span class="op">/</span>intro.html}</span>
<span id="cb10-6"><a href="#cb10-6"></a>}</span></code></pre></div>
</div>
<div id="more-effect-sizes" class="section level2">
<h2 class="hasAnchor">
<a href="#more-effect-sizes" class="anchor"></a>More effect sizes</h2>
<p><a href="TableWei.pdf">See Table 1 in Wei and Higgins (2013) for more formulas</a></p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-Ahn2015">
<p>Ahn, Soyeon, Min Lu, G Tyler Lefevor, Alicia L. Fedewa, and Seniz Celimli. 2015. “Application of Meta-Analysis in Sport and Exercise Science.” In <em>An Introduction to Intermediate and Advanced Statistical Analyses for Sport and Exercise Scientists</em>, edited by Nikos Ntoumanis and Nicholas D. Myers, 233–53. John Wiley &amp; Sons.</p>
</div>
<div id="ref-cooper2019handbook">
<p>Cooper, Harris, Larry V Hedges, and Jeffrey C Valentine. 2019. <em>The Handbook of Research Synthesis and Meta-Analysis</em>. Russell Sage Foundation.</p>
</div>
<div id="ref-craft2003relationship">
<p>Craft, Lynette L, T Michelle Magyar, Betsy J Becker, and Deborah L Feltz. 2003. “The Relationship Between the Competitive State Anxiety Inventory-2 and Sport Performance: A Meta-Analysis.” <em>Journal of Sport and Exercise Psychology</em> 25 (1): 44–65.</p>
</div>
<div id="ref-MetaAnalysis">
<p>Dewey, Michael. 2021. <em>CRAN Task View: Meta-Analysis</em>. manual. <a href="https://cran.r-project.org/web/views/MetaAnalysis.html">https://cran.r-project.org/web/views/MetaAnalysis.html</a>.</p>
</div>
<div id="ref-metavcovR">
<p>Lu, Min. 2021. <em>Variance-Covariance Matrix for Multivariate Meta-Analysis with R Package metavcov</em>. manual. <a href="https://doi.org/10.5281/zenodo.5240826">https://doi.org/10.5281/zenodo.5240826</a>.</p>
</div>
<div id="ref-olkin2009stochastically">
<p>Olkin, I, and L Gleser. 2009. “Stochastically Dependent Effect Sizes.” <em>The Handbook of Research Synthesis and Meta-Analysis</em>, 357–76.</p>
</div>
<div id="ref-olkin1976asymptotic">
<p>Olkin, Ingram. 1976. “Asymptotic Distribution of Functions of a Correlation Matrix.” In <em>Essays in Provability and Statistics: A Volume in Honor of Professor Junjiro Ogawa</em>, 235–51. Shinko Tsusho.</p>
</div>
<div id="ref-Rbase">
<p>R Core Team. 2020. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.</p>
</div>
<div id="ref-wei2013">
<p>Wei, Yinghui, and Julian PT Higgins. 2013. “Estimating Within-Study Covariances in Multivariate Meta-Analysis with Multiple Outcomes.” <em>Statistics in Medicine</em> 32 (7): 1191–1205.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://luminwin.github.io/Lu/articles/cv.html">Min Lu</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
