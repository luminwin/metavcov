<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Multiple Imputation for Missing Data in Meta-Analysis — metami • Computing Variances and Covariances, Visualization and Missing Data Solution for Multivariate Meta-Analysis with metavcov</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Multiple Imputation for Missing Data in Meta-Analysis — metami" />
<meta property="og:description" content="Multiple imputation allows for the uncertainty about the missing data by generating several different plausible imputed data sets and appropriately combining results obtained from each of them. Let  \(\hat{\theta}_{*m}\) be the estimated coefficient from the \(m\)th imputed dataset for one of the \(p\) dimensions in the multivariate outcome, where \(m=1,\dots,M\). The coefficient from MI \(\bar{\theta}\) is  simply just an arithmetic mean of the individual coefficients estimated from each of the \(M\) meta-analysis. We have
$$\bar{\theta}=\frac{\sum_{m=1}^{M}\hat{\theta}_{*m}}{M}.$$
Estimation of the standard error for each variable is little more complicated. Let \(V_W\) be the within imputation variance, which is the average of the variance of the estimated coefficient from each imputed dateset:
  $$V_W=\frac{\sum_{m=1}^{M}V ({\hat{\theta}_{*m}})}{M},$$
where \(V ({\hat{\theta}_{*m}})\) is the variance of the estimator calculated from generalized least squares methods using the imputed dataset. Let \(V_B\) be the between imputation variance, which is calculated as
$$V_B=\frac{\sum_{m=1}^{M}({\hat{\theta}_{*m}}-\bar{\theta})^2}{M-1}.$$
From \(V_W\) and \(V_B\), the variance of the pooled coefficients is calculated as
$$V(\bar{\theta})=V_W+V_B+\frac{V_B}{M}$$
The above variance is statistically principled since \(V_W\) reflects the sampling variance and \(V_B\) reflects the extra variance due to the missing data." />
<meta property="og:image" content="https://github.com/luminwin/metavcov/logo.svg" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-YFJ4LZ36ZN"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-YFJ4LZ36ZN');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Computing Variances and Covariances, Visualization and Missing Data Solution for Multivariate Meta-Analysis with metavcov</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Development version">2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/intro.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
    Introduction
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../reference/metavcov-package.html">Overview</a>
    </li>
    <li>
      <a href="../reference/r.vcov.html">Correlation Coefficients with r.vcov</a>
    </li>
    <li>
      <a href="../reference/mix.vcov.html">All Other Effect Sizes with mix.vcov</a>
    </li>
    <li>
      <a href="../reference/plotCI.html">Data Visualization with plotCI</a>
    </li>
    <li>
      <a href="../reference/metami.html">Multiple Imputation for Missing Data with metami</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Manual</a>
</li>
<li>
  <a href="https://github.com/luminwin/metavcov/issues">Bug Reporting</a>
</li>
<li>
  <a href="https://github.com/luminwin/metavcov/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
    GitHub
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Multiple Imputation for Missing Data in Meta-Analysis</h1>
    
    <div class="hidden name"><code>metami.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Multiple imputation allows for the uncertainty about the missing data by generating several different plausible imputed data sets and appropriately combining results obtained from each of them. Let  \(\hat{\theta}_{*m}\) be the estimated coefficient from the \(m\)th imputed dataset for one of the \(p\) dimensions in the multivariate outcome, where \(m=1,\dots,M\). The coefficient from MI \(\bar{\theta}\) is  simply just an arithmetic mean of the individual coefficients estimated from each of the \(M\) meta-analysis. We have
$$\bar{\theta}=\frac{\sum_{m=1}^{M}\hat{\theta}_{*m}}{M}.$$
Estimation of the standard error for each variable is little more complicated. Let \(V_W\) be the within imputation variance, which is the average of the variance of the estimated coefficient from each imputed dateset:
  $$V_W=\frac{\sum_{m=1}^{M}V ({\hat{\theta}_{*m}})}{M},$$
where \(V ({\hat{\theta}_{*m}})\) is the variance of the estimator calculated from generalized least squares methods using the imputed dataset. Let \(V_B\) be the between imputation variance, which is calculated as
$$V_B=\frac{\sum_{m=1}^{M}({\hat{\theta}_{*m}}-\bar{\theta})^2}{M-1}.$$
From \(V_W\) and \(V_B\), the variance of the pooled coefficients is calculated as
$$V(\bar{\theta})=V_W+V_B+\frac{V_B}{M}$$
The above variance is statistically principled since \(V_W\) reflects the sampling variance and \(V_B\) reflects the extra variance due to the missing data.</p>
    </div>

    <pre class="usage"><span class='fu'>metami</span><span class='op'>(</span><span class='va'>data</span>, M <span class='op'>=</span> <span class='fl'>20</span>, vcov <span class='op'>=</span> <span class='st'>"r.vcov"</span>,
        <span class='va'>r.n.name</span>, <span class='va'>ef.name</span>, x.name <span class='op'>=</span> <span class='cn'>NULL</span>,
        rvcov.method <span class='op'>=</span> <span class='st'>"average"</span>, rvcov.zscore <span class='op'>=</span> <span class='cn'>TRUE</span>,
        type <span class='op'>=</span> <span class='cn'>NULL</span>,
        d <span class='op'>=</span> <span class='cn'>NULL</span>, sdt <span class='op'>=</span> <span class='cn'>NULL</span>, sdc <span class='op'>=</span> <span class='cn'>NULL</span>,
        nt <span class='op'>=</span> <span class='cn'>NULL</span>, nc <span class='op'>=</span> <span class='cn'>NULL</span>,
        st <span class='op'>=</span> <span class='cn'>NULL</span>, sc <span class='op'>=</span> <span class='cn'>NULL</span>,
        n_rt <span class='op'>=</span> <span class='cn'>NA</span>, n_rc <span class='op'>=</span> <span class='cn'>NA</span>,
        r <span class='op'>=</span> <span class='cn'>NULL</span>,
        func <span class='op'>=</span> <span class='st'>"mvmeta"</span>,
        formula <span class='op'>=</span> <span class='cn'>NULL</span>,
        method <span class='op'>=</span> <span class='st'>"fixed"</span>,
        pool.seq <span class='op'>=</span> <span class='cn'>NULL</span>,
        return.mi <span class='op'>=</span> <span class='cn'>FALSE</span>,
        ci.level <span class='op'>=</span> <span class='fl'>0.95</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data </th>
      <td><p>A  \(N \times p\) data frame that contains effect sizes and predictors for meta-regression, if any.</p></td>
    </tr>
    <tr>
      <th>M</th>
      <td><p>Number of imputed data sets.</p></td>
    </tr>
    <tr>
      <th>vcov </th>
      <td><p>Method for computing effect sizes; options including <code>vcov = "r.vcov"</code> for correlation coefficients and <code>vcov = "mix.vcov"</code> for other types of effect sizes. See <code><a href='r.vcov.html'>r.vcov</a></code> and <code><a href='mix.vcov.html'>mix.vcov</a></code> for details.</p></td>
    </tr>
    <tr>
      <th>r.n.name </th>
      <td><p>A string defining the column name for sample sizes in <code>data</code> when the effect sizes are correlation coefficients (<code>vcov = "r.vcov"</code>).</p></td>
    </tr>
    <tr>
      <th>ef.name </th>
      <td><p>A \(p\)-dimensional vector that stores the column names for sample sizes in <code>data</code> when the effect sizes are correlation coefficients (<code>vcov = "r.vcov"</code>).</p></td>
    </tr>
    <tr>
      <th>x.name </th>
      <td><p>A vector that stores the column names in <code>data</code> for predictors for meta-regression.</p></td>
    </tr>
    <tr>
      <th>rvcov.method</th>
      <td><p>Method used for <code><a href='r.vcov.html'>r.vcov</a></code>; options including <code>"average"</code> and <code>"each"</code>.</p></td>
    </tr>
    <tr>
      <th>rvcov.zscore </th>
      <td><p>Whether the correlation coefficients in <code>data</code> are already transformed into Fisher's \(z\) scores.</p></td>
    </tr>
    <tr>
      <th>type </th>
      <td><p>A \(p\)-dimensional vector indicating types of effect sizes for the argument <code>vcov = "mix.vcov"</code>. <code>"MD"</code> stands for mean difference, <code>"SMD"</code> stands for standardized mean difference, <code>"logOR"</code> stands for log odds ratio, <code>"logRR"</code> stands for log risk ratio, and <code>"RD"</code> stands for risk difference.</p></td>
    </tr>
    <tr>
      <th>d </th>
      <td><p>A \(p\)-dimensional vector that stores the column names in <code>data</code> for continuous effect sizes such as MD or SMD. If outcome \(j\) is dichotomous, NA has to be imputed in for \(d[j]\).</p></td>
    </tr>
    <tr>
      <th>sdt </th>
      <td><p>A \(p\)-dimensional vector that stores the column names in <code>data</code> for the sample standard deviations of each outcome from the treatment group. If outcome \(j\) is dichotomous, NA has to be imputed in for \(d[j]\).</p></td>
    </tr>
    <tr>
      <th>sdc </th>
      <td><p>A vector defined in a similar way as <code>sdt</code> for the control group.</p></td>
    </tr>
    <tr>
      <th>nt </th>
      <td><p>A \(p\)-dimensional vector that stores the column names in <code>data</code> for sample sizes of \(p\) outcomes from treatment group.</p></td>
    </tr>
    <tr>
      <th>nc </th>
      <td><p>A vector defined in a similar way as <code>nt</code> for the control group.</p></td>
    </tr>
    <tr>
      <th>st </th>
      <td><p>A \(p\)-dimensional vector that stores the column names in <code>data</code> for the number of participants with event for all outcomes (dichotomous) in the treatment group. If outcome \(j\) is dichotomous, NA has to be imputed in for \(st[j]\).</p></td>
    </tr>
    <tr>
      <th>sc </th>
      <td><p>A vector defined in a similar way as <code>st</code> for the control group.</p></td>
    </tr>
    <tr>
      <th>n_rt</th>
      <td><p>A \(N\)-dimensional list of \(p \times p\) correlation matrices storing sample sizes in the treatment group reporting pairwise outcomes in the off-diagonal elements. See <code><a href='mix.vcov.html'>mix.vcov</a></code> for details.</p></td>
    </tr>
    <tr>
      <th>n_rc</th>
      <td><p>A list defined in a similar way as <code>n_rt</code> for the control group.</p></td>
    </tr>
    <tr>
      <th>r</th>
      <td><p>A \(N\)-dimensional list of \(p \times p\) correlation matrices for the \(p\) outcomes from the \(N\) studies. See <code><a href='mix.vcov.html'>mix.vcov</a></code> for details.</p></td>
    </tr>
    <tr>
      <th>func</th>
      <td><p>A string defining the function to be used for fitting the meta-analysis. Options include <code>func = "metafixed"</code> for fixed-effect meta-analysis (see <code><a href='metafixed.html'>metafixed</a></code> for details). <code>func = "mvmeta"</code>, for which the <code>mvmeta</code> package must be installed beforehand, and <code>func = "meta"</code>, for which the <code>metaSEM</code> package must be installed beforehand.</p></td>
    </tr>
    <tr>
      <th>formula</th>
      <td><p>Formula used for the function  <code>func = "mvmeta"</code> from the <code>mvmeta</code> package when <code>func = "mvmeta"</code>.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Method used for the function  <code>func = "mvmeta"</code> from the <code>mvmeta</code> package when <code>func = "mvmeta"</code>.</p></td>
    </tr>
    <tr>
      <th>pool.seq</th>
      <td><p>A numeric vector indicating if the results are pooled from subsets of the <code>M</code> data sets. By default, the results are only pooled from all <code>M</code> data sets.</p></td>
    </tr>
    <tr>
      <th>return.mi</th>
      <td><p>Should the <code>M</code> imputed data sets be returned?</p></td>
    </tr>
    <tr>
      <th>ci.level</th>
      <td><p>Significant level for the pooled confidence intervals. The default is 0.05.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Min Lu</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>For the imputation phase, this function imports the <code>mice</code> package that imputes incomplete multivariate data by chained equations. The pooling phase is performed via the Rubin's rules.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    

<dt>coefficients</dt><dd><p>A data.frame that contains the pooled results from the <code>M</code> imputed data sets.</p></dd>
<dt>results.mi</dt><dd><p>A \(M\)-dimensional list of results from each imputed data set.</p></dd>
<dt>data.mi </dt><dd><p>A \(M\)-dimensional list of imputed data sets if the argument <code>return.mi = TRUE</code>.</p></dd>
<dt>result.seq</dt><dd><p>A list of results from the pooled results from the subsets of the <code>M</code> imputed data sets if the argument <code>pool.seq = TRUE</code>.</p></dd>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Ahn, S., Lu, M., Lefevor, G.T., Fedewa, A. &amp; Celimli, S. (2016). Application of meta-analysis in sport and exercise science. In N. Ntoumanis, &amp; N. Myers (Eds.), <em>An Introduction to Intermediate and Advanced Statistical Analyses for Sport and Exercise Scientists</em> (pp.233-253). Hoboken, NJ: John Wiley and Sons, Ltd.</p>
<p>Cooper, H., Hedges, L.V., &amp; Valentine, J.C. (Eds.) (2009). <em>The handbook of research synthesis and
meta-analysis.</em> New York: Russell Sage Foundation.</p>
<p>Olkin, I., &amp; Ishii, G. (1976). Asymptotic distribution of functions of a correlation matrix. In S. Ikeda (Ed.),
<em>Essays in probability and statistics: A volume in honor of Professor Junjiro Ogawa</em> (pp.5-51). Tokyo,
Japan: Shinko Tsusho.</p>
<p>Van Buuren, S. and Groothuis-Oudshoorn, K., 2011. mice: Multivariate imputation by chained equations in R. <em>Journal of statistical software</em>, 45(1), pp.1-67.</p>
<p>Gasparrini A., Armstrong, B., Kenward M. G. (2012). Multivariate meta-analysis for non-linear and other multi-parameter associations. <em>Statistics in Medicine</em>. 31(29):3821-3839.</p>
<p>Cheung, M.W.L. (2015). metaSEM: An R Package for Meta-Analysis using Structural Equation Modeling. <em>Frontiers in Psychology</em> 5, 1521.</p>
<p>Rubin, D.B., 2004. <em>Multiple imputation for nonresponse in surveys</em> (Vol. 81). John Wiley &amp; Sons.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>#####################################################################################</span>
<span class='co'># Example: Craft2003 data</span>
<span class='co'># Preparing input arguments for meta.mi() and fixed-effect model</span>
<span class='co'>#####################################################################################</span>
<span class='co'># prepare a dataset with missing values and input arguments for meta.mi</span>
<span class='va'>Craft2003.mnar</span> <span class='op'>&lt;-</span> <span class='va'>Craft2003</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>4</span><span class='op'>:</span><span class='fl'>10</span><span class='op'>)</span><span class='op'>]</span>
<span class='va'>Craft2003.mnar</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='va'>Craft2003</span><span class='op'>$</span><span class='va'>C4</span> <span class='op'>&lt;</span> <span class='fl'>0</span><span class='op'>)</span>, <span class='fl'>6</span><span class='op'>)</span>, <span class='st'>"C4"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='cn'>NA</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='va'>Craft2003.mnar</span>
<span class='va'>n.name</span> <span class='op'>&lt;-</span> <span class='st'>"N"</span>
<span class='va'>ef.name</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"C1"</span>, <span class='st'>"C2"</span>, <span class='st'>"C3"</span>, <span class='st'>"C4"</span>, <span class='st'>"C5"</span>, <span class='st'>"C6"</span><span class='op'>)</span>
<span class='co'># fixed-effect model</span>
<span class='va'>obj</span> <span class='op'>&lt;-</span> <span class='fu'>metami</span><span class='op'>(</span><span class='va'>dat</span>, M <span class='op'>=</span> <span class='fl'>10</span>, vcov <span class='op'>=</span> <span class='st'>"r.vcov"</span>,
             <span class='va'>n.name</span>, <span class='va'>ef.name</span>,
             func <span class='op'>=</span> <span class='st'>"metafixed"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; pooled results from 10 imputations for missing values in C4 
#&gt; Fixed-effects coefficients
#&gt;     Estimate  Std. Error         z  Pr(&gt;|z|)  95%ci.lb  95%ci.ub     
#&gt; C1    0.5169      0.0314   16.4814    0.0000    0.4555    0.5784  ***
#&gt; C2   -0.2558      0.0314   -8.1561    0.0000   -0.3172   -0.1943  ***
#&gt; C3   -0.3182      0.0314  -10.1467    0.0000   -0.3796   -0.2567  ***
#&gt; C4   -0.0596      0.0314   -1.9004    0.0574   -0.1211    0.0019    .
#&gt; C5   -0.0469      0.0314   -1.4971    0.1344   -0.1084    0.0145     
#&gt; C6    0.1382      0.0314    4.4072    0.0000    0.0768    0.1997  ***
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 
#&gt; </div><div class='input'>
<span class='co'>########################</span>
<span class='co'># Plotting the result</span>
<span class='co'>########################</span>
<span class='va'>computvcov</span> <span class='op'>&lt;-</span> <span class='fu'><a href='r.vcov.html'>r.vcov</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='va'>Craft2003</span><span class='op'>$</span><span class='va'>N</span>,
                     corflat <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>Craft2003.mnar</span>, select <span class='op'>=</span> <span class='va'>C1</span><span class='op'>:</span><span class='va'>C6</span><span class='op'>)</span>,
                     method <span class='op'>=</span> <span class='st'>"average"</span><span class='op'>)</span>
<span class='fu'><a href='plotCI.html'>plotCI</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>computvcov</span><span class='op'>$</span><span class='va'>ef</span>, v <span class='op'>=</span> <span class='va'>computvcov</span><span class='op'>$</span><span class='va'>list.vcov</span>,
        name.y <span class='op'>=</span> <span class='cn'>NULL</span>, name.study <span class='op'>=</span> <span class='va'>Craft2003</span><span class='op'>$</span><span class='va'>ID</span>,
        y.all <span class='op'>=</span> <span class='va'>obj</span><span class='op'>$</span><span class='va'>coefficients</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span>,
        y.all.se <span class='op'>=</span> <span class='va'>obj</span><span class='op'>$</span><span class='va'>coefficients</span><span class='op'>[</span>,<span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $`Plotting C1`</div><div class='img'><img src='metami-1.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; 
#&gt; $`Plotting C2`</div><div class='img'><img src='metami-2.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; 
#&gt; $`Plotting C3`</div><div class='img'><img src='metami-3.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; 
#&gt; $`Plotting C4`</div><div class='output co'>#&gt; <span class='warning'>Warning: Removed 6 rows containing missing values (geom_pointrange).</span></div><div class='img'><img src='metami-4.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; 
#&gt; $`Plotting C5`</div><div class='img'><img src='metami-5.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; 
#&gt; $`Plotting C6`</div><div class='img'><img src='metami-6.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; </div><div class='input'>
<span class='co'>########################</span>
<span class='co'># Pooling from subsets</span>
<span class='co'>########################</span>
<span class='va'>o1</span> <span class='op'>&lt;-</span> <span class='fu'>metami</span><span class='op'>(</span><span class='va'>dat</span>, M <span class='op'>=</span> <span class='fl'>10</span>, vcov <span class='op'>=</span> <span class='st'>"r.vcov"</span>,
              <span class='va'>n.name</span>, <span class='va'>ef.name</span>,
              func <span class='op'>=</span> <span class='st'>"metafixed"</span>,
              pool.seq <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; pooled results from 10 imputations for missing values in C4 
#&gt; Fixed-effects coefficients
#&gt;     Estimate  Std. Error         z  Pr(&gt;|z|)  95%ci.lb  95%ci.ub     
#&gt; C1    0.5170      0.0314   16.4825    0.0000    0.4555    0.5784  ***
#&gt; C2   -0.2560      0.0314   -8.1642    0.0000   -0.3175   -0.1945  ***
#&gt; C3   -0.3182      0.0314  -10.1458    0.0000   -0.3796   -0.2567  ***
#&gt; C4   -0.0501      0.0314   -1.5976    0.1101   -0.1116    0.0114     
#&gt; C5   -0.0470      0.0314   -1.4998    0.1337   -0.1085    0.0144     
#&gt; C6    0.1382      0.0314    4.4058    0.0000    0.0767    0.1997  ***
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 
#&gt; </div><div class='input'><span class='co'># pooled results from M = 5 imputed data sets</span>
<span class='va'>o1</span><span class='op'>$</span><span class='va'>result.seq</span><span class='op'>$</span><span class='va'>M5</span><span class='op'>$</span><span class='va'>coefficients</span>
</div><div class='output co'>#&gt;       Estimate Std. Error           z     Pr(&gt;|z|)    95%ci.lb    95%ci.ub
#&gt; C1  0.51683598 0.03136417  16.4785456 0.000000e+00  0.45536333  0.57830863
#&gt; C2 -0.25631789 0.03135624  -8.1743812 2.220446e-16 -0.31777500 -0.19486078
#&gt; C3 -0.31804815 0.03135804 -10.1424747 0.000000e+00 -0.37950878 -0.25658751
#&gt; C4 -0.01607465 0.03135730  -0.5126286 6.082112e-01 -0.07753384  0.04538454
#&gt; C5 -0.04727197 0.03135605  -1.5075871 1.316602e-01 -0.10872869  0.01418475
#&gt; C6  0.13815009 0.03136602   4.4044512 1.060520e-05  0.07667382  0.19962635</div><div class='input'><span class='co'># pooled results from M = 10 imputed data sets</span>
<span class='va'>o1</span><span class='op'>$</span><span class='va'>result.seq</span><span class='op'>$</span><span class='va'>M10</span><span class='op'>$</span><span class='va'>coefficients</span>
</div><div class='output co'>#&gt;       Estimate Std. Error          z     Pr(&gt;|z|)    95%ci.lb    95%ci.ub
#&gt; C1  0.51696741 0.03136463  16.482497 0.000000e+00  0.45549387  0.57844096
#&gt; C2 -0.25600261 0.03135676  -8.164193 2.220446e-16 -0.31746073 -0.19454450
#&gt; C3 -0.31815427 0.03135835 -10.145761 0.000000e+00 -0.37961549 -0.25669304
#&gt; C4 -0.05009895 0.03135803  -1.597643 1.101224e-01 -0.11155955  0.01136166
#&gt; C5 -0.04702938 0.03135615  -1.499845 1.336544e-01 -0.10848629  0.01442754
#&gt; C6  0.13819176 0.03136610   4.405768 1.054095e-05  0.07671534  0.19966818</div><div class='input'><span class='co'>#########################################################################################</span>
<span class='co'># Running random-effects and meta-regression model using packages "mvmeta" or "metaSEM"</span>
<span class='co'>#########################################################################################</span>
<span class='co'># Restricted maximum likelihood (REML) estimator from the mvmeta package</span>
<span class='co'># library(mvmeta)</span>
<span class='co'># o2 &lt;- metami(dat, M = 10, vcov = "r.vcov",</span>
<span class='co'>#                     n.name, ef.name,</span>
<span class='co'>#                     formula = as.formula(cbind(C1, C2, C3, C4, C5, C6) ~ . ),</span>
<span class='co'>#                     func = "mvmeta",</span>
<span class='co'>#                     method = "reml")</span>
<span class='co'># maximum likelihood estimators from the metaSEM package</span>
<span class='co'># library(metaSEM)</span>
<span class='co'># o3 &lt;- metami(dat, M = 10, vcov = "r.vcov",</span>
<span class='co'>#               n.name, ef.name,</span>
<span class='co'>#               func = "meta")</span>

<span class='co'># meta-regression</span>
<span class='co'># library(metaSEM)</span>
<span class='co'># o4 &lt;- metami(dat, M = 10, vcov = "r.vcov",</span>
<span class='co'>#                     n.name, ef.name, x.name = "p_male",</span>
<span class='co'>#                     func = "meta")</span>
<span class='co'># library(mvmeta)</span>
<span class='co'># o5 &lt;- metami(dat, M = 20, vcov = "r.vcov",</span>
<span class='co'>#               n.name, ef.name, x.name = "p_male",</span>
<span class='co'>#               formula = as.formula(cbind(C1, C2, C3, C4, C5, C6) ~ p_male ),</span>
<span class='co'>#               func = "mvmeta",</span>
<span class='co'>#               method = "reml")</span>
<span class='co'>#####################################################################################</span>
<span class='co'># Example: Geeganage2010 data</span>
<span class='co'># Preparing input arguments for meta.mi() and fixed-effect model</span>
<span class='co'>#####################################################################################</span>
<span class='co'># Geeganage2010.mnar &lt;- Geeganage2010</span>
<span class='co'># Geeganage2010.mnar$MD_SBP[sample(1:nrow(Geeganage2010),7)] &lt;- NA</span>
<span class='co'># r12 &lt;- 0.71</span>
<span class='co'># r13 &lt;- 0.5</span>
<span class='co'># r14 &lt;- 0.25</span>
<span class='co'># r23 &lt;- 0.6</span>
<span class='co'># r24 &lt;- 0.16</span>
<span class='co'># r34 &lt;- 0.16</span>
<span class='co'># r &lt;- vecTosm(c(r12, r13, r14, r23, r24, r34))</span>
<span class='co'># diag(r) &lt;- 1</span>
<span class='co'># mix.r &lt;- lapply(1:nrow(Geeganage2010), function(i){r})</span>
<span class='co'># o &lt;- metami(data = Geeganage2010.mnar, M = 10, vcov = "mix.vcov",</span>
<span class='co'>#               ef.name = c("MD_SBP", "MD_DBP", "RD_DD", "lgOR_D"),</span>
<span class='co'>#               type = c("MD", "MD", "RD", "lgOR"),</span>
<span class='co'>#               d = c("MD_SBP", "MD_DBP", NA, NA),</span>
<span class='co'>#               sdt = c("sdt_SBP", "sdt_DBP", NA, NA),</span>
<span class='co'>#               sdc = c("sdc_SBP", "sdc_DBP", NA, NA),</span>
<span class='co'>#               nt = c("nt_SBP", "nt_DBP", "nt_DD", "nt_D"),</span>
<span class='co'>#               nc = c("nc_SBP", "nc_DBP", "nc_DD", "nc_D"),</span>
<span class='co'>#               st = c(NA, NA, "st_DD", "st_D"),</span>
<span class='co'>#               sc = c(NA, NA, "sc_DD", "sc_D"),</span>
<span class='co'>#               r = mix.r,</span>
<span class='co'>#               func = "metafixed")</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://luminwin.github.io/Lu/articles/cv.html'>Min Lu</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


